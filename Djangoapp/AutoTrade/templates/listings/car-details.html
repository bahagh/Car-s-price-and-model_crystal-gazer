
{% extends 'base.html' %}
{% load humanize %}
{% load static %}

{% block content %}



      <section class="section section-bg p-5 mb-2" id="call-to-action" style="background-image: url({% static 'images/baanner-image-1-1920x500.jpg'%})">
          <div class="container">
              <div class="row">
                  <div class="col-lg-10 offset-lg-1">
                      <div class="cta-content">
                          <br>
                          <br>
                          {% include 'partials/_alerts.html' %}
                          <h1>{{ listing.title}}</h1>
                          <div class="rating-star">
                            <span>
                              <i class="fa fa-star{% if listing.avaregereview < 1 %}-o {% endif %}"  ></i>
                              <i class="fa fa-star{% if listing.avaregereview < 2 %}-o {% endif %}"  ></i>
                              <i class="fa fa-star{% if listing.avaregereview < 3 %}-o {% endif %}"  ></i>
                              <i class="fa fa-star{% if listing.avaregereview < 4 %}-o {% endif %}"  ></i>
                              <i class="fa fa-star{% if listing.avaregereview < 5 %}-o {% endif %}"  ></i>
                            </span>
                            {{ listing.avaregereview |stringformat:".2f"}}
                          </div>
                          <a> {{ listing.countreview }} Review(s)  </a>
                          <p>Price starting from.</p>
                          <h2><em> {{ listing.price | intcomma }} DT</em>  </h2>
                          {% if listing.Predictedprice == 0%}
                                  <small>We can't predict the price of this car </samll>
                          {% else %}
                            <h5>  Our estimated Price </h5><small>With out taking on consideration all Vehicle Extras</small>
                            <h3>{{ listing.Predictedprice | intcomma }} DT</h3></h2>
                         {% endif %}
                      </div>
                  </div>
              </div>
          </div>
      </section>
      <!-- ***** Call to Action End ***** -->

      <!-- ***** Fleet Starts ***** -->
      <section class="section" id="trainers">
          <div class="container">
              <br>
              <br>

              <div id="carouselExampleIndicators" class="carousel slide" data-ride="carousel">
                <ol class="carousel-indicators">
                  <li data-target="#carouselExampleIndicators" data-slide-to="0" class="active"></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="1" ></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="2" ></li>
                  <li data-target="#carouselExampleIndicators" data-slide-to="3" ></li>
                </ol>
                <div class="carousel-inner">
                  {% if listing.photo_1 %}
                    <div class="carousel-item active">
                      
                      <img class="d-block w-70 mx-auto"  src="{{ listing.photo_1.url }}" alt="First slide">
                    </div>
                  {% endif %}
                    {% if listing.photo_2 %}
                    <div class="carousel-item">
                      <img class="d-block w-70 mx-auto"  src="{{ listing.photo_2.url }}" alt="Second slide">
                    </div>
                  {% endif %}
                  {% if listing.photo_3 %}
                    <div class="carousel-item">
                      <img class="d-block w-70 mx-auto"  src="{{ listing.photo_3.url }}" alt="Third slide">
                    </div>
                  {% endif %}
                  {% if listing.photo_4 %}
                    <div class="carousel-item">
                      <img class="d-block w-70 mx-auto"  src="{{ listing.photo_4.url }}" alt="fourth slide">
                    </div>
                  {% endif %}
                  {% if listing.photo_5 %}
                    <div class="carousel-item">
                      <img class="d-block w-70 mx-auto"  src="{{ listing.photo_5.url }}" alt="feith slide">
                    </div>
                  {% endif %}
                  {% if listing.photo_6 %}
                    <div class="carousel-item">
                      <img class="d-block w-70 mx-auto"  src="{{ listing.photo_6.url }}" alt="sexth slide">
                    </div>
                  {% endif %}
                </div>
                <a class="carousel-control-prev" href="#carouselExampleIndicators" role="button" data-slide="prev">
                  <span class="carousel-control-prev-icon .mx-auto" aria-hidden="true"></span>
                  <span class="sr-only">Previous</span>
                </a>
                <a class="carousel-control-next" href="#carouselExampleIndicators" role="button" data-slide="next">
                  <span class="carousel-control-next-icon .mx-auto" aria-hidden="true"></span>
                  <span class="sr-only">Next</span>
                </a>
              </div>
              
              <br>
              <br>

              <div class="row" id="tabs">
                <div class="col-lg-4">
                  <ul>
                    <li><a href='#tabs-1'><i class="fa fa-cog"></i> Vehicle Specs</a></li>
                    <li><a href='#tabs-2'><i class="fa fa-info-circle"></i> Vehicle Description</a></li>
                    <li><a href='#tabs-3'><i class="fa fa-plus-circle"></i> Vehicle Extras</a></li>
                    <li><a href='#tabs-4'><i class="fa fa-phone"></i> Contact Details</a></li>
                     
                    <a>Market of {{ listing.Model }} in tunisia : </a>
                    <br>
                    <br>
                     
                    <a href={% url 'analyser' listing.id%}>
                    <button type="button" class="btn btn-info">Analyser</button>
                    </a>
                  </ul>
                  
                </div>
                
                <div class="col-lg-8">
                  <section class='tabs-content' style="width: 100%;">
                    <article id='tabs-1'>
                      <h4>Vehicle Specs</h4>

                      <div class="row">

                        <div class="col-sm-6">
                              <label>Make</label>
                            
                              <p>{{ listing.Make}}</p>
                        </div>

                        <div class="col-sm-6">
                              <label> Model</label>
                        
                              <p>{{ listing.Model}}</p>
                        </div>

                        <div class="col-sm-6">
                              <label>Mileage</label>
                        
                              <p>{{ listing.Mileage | intcomma}} KM</p>
                        </div>

                        <div class="col-sm-6">
                              <label>Fuel</label>
                        
                              <p>{{ listing.Fuel}}</p>
                        </div>

                        <div class="col-sm-6">
                              <label>Engine Horsepower</label>
                        
                              <p>{{ listing.Engine_Horsepower}} CV</p>
                        </div>



                        <div class="col-sm-6">
                              <label>Transmission</label>
                        
                              <p>{{ listing.Transmission}}</p>
                        </div>

                        <div class="col-sm-6">
                              <label>Number of seats</label>
                        
                              <p>{{ listing.Number_of_seats}}</p>
                        </div>

                        <div class="col-sm-6">
                              <label>Doors</label>
                        
                              <p>{{ listing.Doors}}</p>
                        </div>

                        <div class="col-sm-6">
                              <label>Color</label>
                        
                              <p>{{ listing.Color}}</p>
                        </div>
                      </div>
                    </article>
                    <article id='tabs-2'>
                      <h4>Vehicle Description</h4>
                      <p>{{ listing.Vehicle_description}}</p>
                    </article>
                    <article id='tabs-3'>
                      <h4>Vehicle Extras</h4>
                      <h5>Exterieur equipment</h5>
                       <p>{{ listing.Vehicle_extras}}</p>
                      <h5>Interior equipment</h5>
                      <p>{{ listing.Vehicle_extras_Interior}}</p>
                      <h5>Safety equipment</h5>
                      <p>{{ listing.Vehicle_extras_Safety}}</p>
                    </article>
                    <article id='tabs-4'>
                      <h4>Contact Details</h4>

                      <div class="row">   
                          <div class="col-sm-6">
                              <label>Name</label>

                              <p>{{ listing.owner}}</p>
                          </div>
                          <div class="col-sm-6">
                              <label>Phone number</label>

                              <p>{{ listing.Phone_number}}</p>
                          </div>
                          <div class="col-sm-6">
                              <label>Address</label>
                              <p>{{ listing.address}}</p>
                          </div>
                          <div class="col-sm-6">
                              <label>Governorate</label>
                              <p>{{ listing.Governorate}}</p>
                          </div>
                      </div>
                    </article>
                    
                  </section>
                </div>
              </div>
          </div>
          <br>


 
  
 <!-- Review section -->
 <br>
               <div class='container'>
                  <form action="{% url 'submit_review' listing.id %}" method="POST"  >
                    {% csrf_token %}
                    <h5>Write Your Review</h5>

                    <div>
                     <!--  Rating stars -->
                      <label>Review  Rate Predection !!</label>
                      <br>
                    
                      <br>
                      Review Title:
                      <input type="text" class="form-control" name="subject" required>
                      <br>
                      Review:
                      <textarea name="review" rows="4" class="form-control" required></textarea>
                      <br>
                      {% if user.is_authenticated %}
                        {% if listing %}
                          <button type="submit" value="Submit Review" id="btnFetch" class="spinner-button" >Submit Review</button>

                        {% endif %}
                      {% else %}
                      <p>You must be logged in to post a review. <span><a href="{% url 'login' %}">Login now</a></span></p>
                      {% endif %}
                      
                      </div>
                         
                        </form>
                      <br>

                    {% for review in reviews %}
                          {% if review.car_id == listing.id %}
                              <article class="box mb-3">
                                <div class="icontext w-100">
                                  
                                  <div class="text">
                                    <span class="date text-muted float-md-right">{{review.updated_at}} </span>
                                    <h6 class="mb-1">{{review.user.username}} </h6>
                                    <div class="rating-star">
                                      <span>
                                        <i class="fa fa-star{% if review.rating == 0.5 %}-half-o{% elif review.rating < 1 %}-o {% endif %}" aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 1.5 %}-half-o{% elif review.rating < 2 %}-o {% endif %}" aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 2.5 %}-half-o{% elif review.rating < 3 %}-o {% endif %}" aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 3.5 %}-half-o{% elif review.rating < 4 %}-o {% endif %}" aria-hidden="true"></i>
                                        <i class="fa fa-star{% if review.rating == 4.5 %}-half-o{% elif review.rating < 5 %}-o {% endif %}" aria-hidden="true"></i>
                                      </span>
                                    </div>
                                    
                                  </div>
                                </div> <!-- icontext.// -->
                                <div class="mt-3">
                                  <h6>{{review.subject}}</h6>
                                  <p>
                                    {{review.review}}
                                  </p>
                                </div>
                                {% if request.user.username == review.user.username  %}
                              <p><a class="btn btn-danger" href="{% url 'delete' review.user.id %}">Delete Your Review<a/></p>
                                {% endif %}
                              </article>
                             
                        {% endif %}
                      
                     {% endfor %}

                </div>
      </div> <!-- col.// -->
    </div> <!-- row.// -->


  </div> <!-- container .//  -->

  </section>
<script>
  $('#btn-one').click(function() {
    $('#btn-one').html('<span class="spinner-border spinner-border-sm mr-2" role="status" aria-hidden="true"></span>Loading...').attr('disabled', true);
  });

</script>

{% endblock %}